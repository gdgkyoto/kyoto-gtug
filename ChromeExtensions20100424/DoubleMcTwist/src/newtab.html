<!doctype html>
<html>
	<head>
		<link rel="stylesheet" href="css/main.css" type="text/css">
		<title>Double Mctwist</title>

		<script src="js/jquery-1.4.1.min.js"></script>
		<script>
			var alreadySet = false;
			var ANIMATE_TIME = 1000;
			
			function setSelectBox(d) {
				if (!d || d.length == 0) {
					return;
				}
				
				for (var i = 0; i < d.length; i++) {
					$('#timeline').append('<option value="' + d[i].url + '">' + d[i].title + '</option>');
				}
				
				startPreview();
			}
			
			function swap(){
				var top = $('.preview.top'),
					back = $('.preview:not(.top)');
			}
			
			function change(){
				var top = $('.preview.top'),
					back = $('.preview:not(.top)'),
					selected = $('#timeline option:selected'),
					next;
				
				top.removeClass('top').animate({opacity:0}, ANIMATE_TIME);
				back.addClass('top').css('display', 'block').animate({opacity:1}, ANIMATE_TIME);

				if (!selected) {
					selected = $('#timeline option:first');
				}
				next = selected.next();
				
				if (!back.attr('src') || back.attr('src').length == 0) {
					back.attr('src', selected.val());
				}
				
				setTimeout(function(){
					top.attr('src', next.val()).css('display', 'none');
				}, ANIMATE_TIME);
			}
			
			function startPreview(){
				(function(){
					var selected = $('#timeline option:selected'),
						next;
					
					if (!selected || selected.length == 0) {
						next = $('#timeline option:first');
					} else {
						next = selected.next();
					}
					
					next.attr('selected', 'selected');
					
					change();
					
					setTimeout(arguments.callee, 5000);
				})();
			};
			
			$(function(){
				$('#timeline').change(function(){change();});
			});
		</script>
	</head>
	<body>
		<div id="content">
			<select id="timeline"></select><br>
			<iframe class="preview" scrolling="no"></iframe>
			<iframe class="preview top" scrolling="no"></iframe>
		</div>
	</body>
</html>